# Veridian Dynamics Vault Documentation
This is the documentation for the Veridian Dynamics Vault installation.  The installation was comprised of two separate installations with the bastions for the two primary clusters being located at 54.201.231.244 and 3.91.104.217.  These installations will be referred to as Installation A and Installation B respectively.

## Access
### Recovery Keys
Recovery keys have been encrypted using the following keybase ids respectively: branharrhpe, redacted\_ahead, jacktvalley19.
1. wcFMA/sB8fFuCCkxARAAT2ei52Ze6nnNChbrEKRJVEWVllxvl1ofux9OdstlQx1jOBPrSKSGtkyXTvJ8UfTKPRfGOz3gcGQfbuzmMyuNHQYclPi4Q/td2yOev9bWQyXvg88xfpPcWC7L/fxiihHaMeoKpeS8xJYlcGi7+pbpHszjBdswM9oNm/kYbLPAqUgqjc5xP/1I6A2jYFOqCwKvQZfFhBn5KpCjchDh90pf6Zh3VzOgoNMuP3XQWByjUY7oG7lqAES0ZhxOjJFJqXufNa9y1tPkpC7QiCmeEqC6hKciGIWHtQ74SjUl8p0Wdfb2e2tfhL30LLiYXayrVztfP6F3LCy2L4fZcNO1F8n7y1PDTU4zxWQUBTLA35NF9EG2bPpAuEO1ceUNDbvgxSt4cxyxjfLAhD2QspkRwGDeN+jFhw3PRX/JJxj1/EcHrF1zen122pyKrTQoG3wi03Fl86k0ZMlk3ymofq4cMMw8UxZQiLD1E2q6OMxKKd7AsixQjKmZrCN/Beeg+MsXQGGxLYvyCygLrZ+GzbjWKU8J9jkWPC9M3xE11UxULjRCAEXufk33beeKLUKnyihHufwgmH21V0fCE6Xp/JljOuYqT2+GO8KQ6qW/6VWf4ZRjo8do7UO/5YY+qhAPlIFvFjyX4osIuIhwBycBUhPToMkYK2VO3Ws7XSTEId3wcPieZGvS4AHktqW4D0oySgmybwCJd4Iu7uFrouAu4HbhMmzgceJy8pKL4Ebm8YHuMAhLbcb/k/VdKGndBPq5t4+QmgnwjA5UMYD0TmCruPU9b4o4XQ4TOjwtY4T/w5DnJcz4XHgVOolNSR/pFuAw4dn04B7k6Dhc6hhFAzNGKRknzZb8T+JHuIQf4QN+AA==
2. wcFMA+ZSnEn1Z4rOARAADOfE1KzrxM0kTBbvlwbEyZ+3kILkihjuDlunPtH0+ZfKnDp10/4G8hHklKVTKbIV9u/iow8/D7oWNT7FkcxaJzDnxGtx4aFx9VudN5hl6MLmgytiuuHsEavt4DGJ6JLhyj3Fy5lsNgoPfUoh/wBUpojcSJzJQirScKOflwn9xhYlVFMTIlLzcvChXCDL3UpmvDo2rHTHqkxpmxHVn/9p/MTBdtc8qyTDemq1fhsxmj4+1vdc08vaPqLeDg2M07M1KuX9cKJWzjWhen128s2EmXOLstVu2ag718sZIFU9VqRr/UxU9fT3vlDE8j/BDlUc3UlwQu/1wxefe4nHjtQC5UeM3Ag8qTjMojbuaiAvT8FSKF+RTn5qpM/8OfFj28Q3bw8C6hTlt8dYy7pizq7R5F7HnBvpWe04JirEK2Y5WYJyBXZQCSQaihw0DRnmqsQTKZEdxiuJMGFzrck504ZuoZkQWOaa9tdhqnhvawajELJ+qdbrGSkx62P8eGo8CUJFVydXEafNCGHEyCkL6Miyit088PBpuHaJDXYqP26dFSpbTiKXtH+1gRlhc+yCdcjco2pfP9oJWXWSjOP6tiZkyOEMsvg9xLOXdePKBb//LAW5h9s35pal/lXKk14ExoP2H90lv6fmz/Joio/+pjHnquY08NlSDwKVLen7xn3NM2vS4AHkkgmtwyCGLt4R+LpIg2/Ux+GC7+Bg4IjhHFbgfeINfPGY4N3mGnQXnjmYLBK3eTuUpn6a6f5/+u5gEuAiLP0YWtaiZMY02YDv0KGyZ5w3IBpgrJyfKi0JoQgX1baOpN99CVTa9+Co4ZxZ4ALk6Eh0azJMnPOhRylJiPdx/OLGV3yj4bk6AA==
3. wcBMA2BDeoT94YNeAQgAOrPnsria24onqOeputvffhr98tt2pYG/XwEq7GuolUQSEJci4RdjboNMncJUjXnwrLNTf00jsrIcXJ3yJ+kS8aZgRbM+zAlDlJI9TZctKs5gERPp5st5GqWp8gnL/9kEQ6qVjPEHseXp1o0n/Jh3l73VgZbq6XcojARr+7mGBCfFimH7qoLYTUsYqtSgWpNiktmXnkdTvhtRxelA0odhn+F6Cm7esxXH7nECLC0+H7Uun5wZ5YXi02G2A84ZisZC8CZ2NSgPjitOp5bBpvEe7T3WV2JNeMDEOdbarjm+4O6OpZ6cmsYrgULUrg+0iTTqkiosJnn+zoBYmat11IRVW9LgAeQTS0RD7H7f3p4o4PgKfdpW4We+4LDg3+FsPOCK4j1hyCHgqeYb9VaP6HlGuHRjS/qr5ZXp/fuwcK36nweSkN/FtZmWE0cXXHYolpx4vGA1TJuEWqDYHlE1/+SH2DUnaIWIIcxr4M/hoZ3gK+T191uudo//cq2usJjaDOx44p5cgEXh/6UA

## Scope and Status
Certain portions were not able to be completed, and the install has been split into two separate installations as noted above.

### Proposed Architecture
| Proposed | Status | Notes |
| -------- | ------ | ----- |
| Primary Vault Cluster | Completed for both installation A and B | Set up with a 3 node vault cluster and 5 node consul cluster. |
| DR of Primary Cluster | Spun up for A.  Not configured but tokens have been created.  Not done for B | VPCs were not peering correctly so the different clusters could not communicate with the main cluster |
| Performance Replica in Europe | Not done | Problems as noted above and time constraints |
| DR Replica of Europe | Not done | Problems as noted above and time constraints |
| Performance Replica in Asia | Not done | Problems as noted above and time constraints |

### Additional Requirements for the Architecture
| Requirement | Status | Notes |
| ----------- | ------ | ----- |
| Secure storage of keys without exposing to one person. | Complete. | See documenation above |
| Configure audit device | Partially complete. | Vault is outputting audit logs to Unix Syslog.  However, Cloudwatch is not reading the syslogs because of difficulties interfacing AWS with the clients. | 
| Configure user authentication | Partially complete | Userpass is set up as an authentication method.  Active Directory could not be set up because of access issues. |
| Configure namespace for the security team. | Complete. | Namespace is called *secops*. |
| Leave behind documenation. | Complete | |

### Use Cases
| Potential Use Case | Status | Notes |
| ------------------ | ------ | ----- |
| Use Dynamic Database credentials in the ERP app. | Complete | Vault agent has successfully been installed in the ERP application.  Vault agent reads and autorenews secrets about the database engine and stores them into the `mysqldbcreds.json` file which the ERP application reads for DB access. |
| Add encryption and decryption capabilities to the ERP app. | Complete | Using the vault agent on the ERP app, the ERP application can successfully encrypt and decrypt arbitrary text through the transit endpoint. The vault agent has been placed into a systemd service to ensure that it is always running. |
| Update ERP app to use s3 credentials | Not attempted | Not attempted due to time constraints |
| Enable ssh otp for company vms | Completed | Secrets engine can create arbitrary passwords for any ip.  Not able to test because not provided with company VMs by the customer. |
| Seperate KV engine for security | Complete | Located at secret/kv |
